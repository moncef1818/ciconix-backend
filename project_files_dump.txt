ðŸ“„ FILE: .gitignore
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 51 | Size: 4.0K

.env
venv/
__pycache__/
db.sqlite3

# --- Python ---
__pycache__/
*.py[cod]
*$py.class

# --- Django ---
*.log
local_settings.py
db.sqlite3
db.sqlite3-journal

# --- Media & Static ---
media/
!media/.gitkeep
staticfiles/

# --- Environments ---
.env
.venv
env/
venv/
ENV/
env.bak/
venv.bak/

# --- IDEs & Editors ---
.vscode/
.idea/
*.iml
*.code-workspace

# --- OS ---
.DS_Store

# --- Testing ---
.coverage
htmlcov/
.pytest_cache/

# --- Celery ---
celerybeat-schedule
celerybeat.pid

# -- teams generated passwords ---
secure_data/
team_passwords.csv
*.csv
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: build.sh
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 8 | Size: 0

#!/usr/bin/env bash
set -o errexit

# Install dependencies
pip install -r requirements.txt

# ONLY run migrations (no collectstatic!)
python manage.py migrate --noinput

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ciconix/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - ciconix/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ciconix/asgi.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 16 | Size: 0

"""
ASGI config for ciconix project.

It exposes the ASGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/4.2/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'ciconix.settings')

application = get_asgi_application()

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ciconix/settings.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 233 | Size: 8.0K

"""
Django settings for ciconix project.

Generated by 'django-admin startproject' using Django 4.2.11.

For more information on this file, see
https://docs.djangoproject.com/en/4.2/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/4.2/ref/settings/
"""

import os
from pathlib import Path
from dotenv import load_dotenv 

load_dotenv()

BASE_DIR = Path(__file__).resolve().parent.parent

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent

TEAM_PASSWORDS_DIR = os.path.join(BASE_DIR, 'secure_data')
# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/4.2/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = os.getenv('SECRET_KEY')

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = os.getenv('DEBUG') == 'True'

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = [
    'corsheaders',
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django_ratelimit',

    'rest_framework',
    'rest_framework_simplejwt',
    'rest_framework_simplejwt.token_blacklist',


    'registration',
    'teams',
    'hackathon',
    'ctfd',
    'leaderboard',
    'tokens',

]



#CACHES = {
 #   'default': {
   #     'BACKEND': 'django.core.cache.backends.locmem.LocMemCache',
    #    'LOCATION': 'unique-snowflake',
    #}
#}



REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': [
        'rest_framework_simplejwt.authentication.JWTAuthentication', 
    ],
    'DEFAULT_PERMISSION_CLASSES': [
        'rest_framework.permissions.IsAuthenticated',  
    ],
}

AUTH_USER_MODEL = 'teams.Team'  

from datetime import timedelta
SIMPLE_JWT = {
    'ACCESS_TOKEN_LIFETIME': timedelta(days=1),  # Token lasts 1 day
    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),
    'AUTH_HEADER_TYPES': ('Bearer',),
}

MIDDLEWARE = [
    'corsheaders.middleware.CorsMiddleware',
    'django.middleware.security.SecurityMiddleware',
    'whitenoise.middleware.WhiteNoiseMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'ciconix.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'ciconix.wsgi.application'


# Database
# https://docs.djangoproject.com/en/4.2/ref/settings/#databases

import dj_database_url

from decouple import config
import dj_database_url

DATABASES = {
    'default': dj_database_url.config(
        default=config('DATABASE_URL')
    )
}

CACHES = {
    'default': {
        'BACKEND': 'django_redis.cache.RedisCache',
        'LOCATION': 'redis://127.0.0.1:6379/1',
        'OPTIONS': {
            'CLIENT_CLASS': 'django_redis.client.DefaultClient',
        }
    }
}

RATELIMIT_ENABLE = True
RATELIMIT_USE_CACHE = 'default'

# Password validation
# https://docs.djangoproject.com/en/4.2/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/4.2/topics/i18n/

LANGUAGE_CODE = 'en-us'

TIME_ZONE = 'UTC'

USE_I18N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/4.2/howto/static-files/
# Production static files (REQUIRED for Render)
STATIC_URL = '/static/'
STATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')

STATICFILES_DIRS = []


# Default primary key field type
# https://docs.djangoproject.com/en/4.2/ref/settings/#default-auto-field

DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'

CORS_ALLOWED_ORIGINS = [
    "http://localhost:5173",
    "http://127.0.0.1:5173",
    "http://192.168.56.1:5173",     # Your VM IP
    "http://127.0.0.1:5173",        # Localhost
    "https://your-frontend.netlify.app",  
    "https://ciconix.netlify.app",
    'http://localhost',
    'http://127.0.0.1',
    'http://192.168.0.133:5173',
]

CORS_ALLOW_METHODS = [
    'DELETE',
    'GET',
    'OPTIONS',
    'PATCH',
    'POST',
    'PUT',
]

CORS_ALLOW_HEADERS = [
    'accept',
    'accept-encoding',
    'authorization',
    'content-type',
    'dnt',
    'origin',
    'user-agent',
    'x-csrftoken',
    'x-requested-with',
]
CORS_ALLOW_CREDENTIALS = True
CTFD_URL = os.getenv('CTFD_URL')
CTFD_API_TOKEN = os.getenv('CTFD_API_TOKEN')

ALLOWED_HOSTS = ['*']
DEBUG = True
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ciconix/urls.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 31 | Size: 4.0K

"""
URL configuration for ciconix project.

The `urlpatterns` list routes URLs to views. For more information please see:
    https://docs.djangoproject.com/en/4.2/topics/http/urls/
Examples:
Function views
    1. Add an import:  from my_app import views
    2. Add a URL to urlpatterns:  path('', views.home, name='home')
Class-based views
    1. Add an import:  from other_app.views import Home
    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')
Including another URLconf
    1. Import the include() function: from django.urls import include, path
    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))
"""
from django.contrib import admin
from django.urls import include, path
from django.conf.urls.static import static
from . import settings


urlpatterns = [
    path('admin/', admin.site.urls),
    path('api/registration/', include('registration.urls')),
    path('api/teams/', include('teams.urls')),
    path('api/projects/', include('hackathon.urls')),
    path('api/leaderboard/', include('leaderboard.urls')),
    path('api/ctfd/', include('ctfd.urls')),
    path('api/tokens/', include('tokens.urls')),
]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ciconix/wsgi.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 16 | Size: 0

"""
WSGI config for ciconix project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/4.2/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'ciconix.settings')

application = get_wsgi_application()

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ctfd/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - ctfd/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ctfd/admin.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 3 | Size: 0

from django.contrib import admin

# Register your models here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ctfd/apps.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 5 | Size: 0

from django.apps import AppConfig


class CtfdConfig(AppConfig):
    name = 'ctfd'

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ctfd/migrations/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - ctfd/migrations/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ctfd/models.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 3 | Size: 0

from django.db import models

# Create your models here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ctfd/service.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 62 | Size: 4.0K

import requests
from django.conf import settings
from django.core.cache import cache

class CTFdService:

    @staticmethod
    def get_team_scores():
        cache_key = 'ctfd_leadearboard_scores'
        cached_data = cache.get(cache_key)

        if cached_data:
            return cached_data
        
        ctfd_url = settings.CTFD_URL
        ctfd_token = settings.CTFD_API_TOKEN
        headers = {
            'Authorization': f'Token {ctfd_token}',
            'Content-Type': 'application/json'
        }
        try:
            response = requests.get(f'{ctfd_url}/api/v1/scoreboard', headers=headers, timeout=10)
            if response.status_code == 200:
                data = response.json().get('data', [])
                scores = {team['account_id']: team['score'] for team in data}
                cache.set(cache_key, scores, timeout=300)  # Cache for 5 minutes
                return scores
        
        except requests.RequestException as e:
            print(f"Error fetching CTFd scores: {e}")
            return {}
        return {}
    
    @staticmethod
    def get_team_score(team_id):
        cache_key = f'ctfd_team_score_{team_id}'
        cached_score = cache.get(cache_key)
        if cached_score:
            return cached_score
        
        ctfd_url = settings.CTFD_URL
        ctfd_token = settings.CTFD_API_TOKEN

        headers = {
            'Authorization': f'Token {ctfd_token}',
            'Content-Type': 'application/json'
        }
        try:
            response = requests.get(f'{ctfd_url}/api/v1/teams/{team_id}', headers=headers, timeout=10)
            if response.status_code == 200:
                data = response.json().get('data',{})
                score = data.get('score', 0)
                cache.set(cache_key, score, timeout=300)  # Cache for 5 minutes
                return score
        except requests.RequestException as e:
            print(f"Error fetching CTFd team score: {e}")
            return 0
        return 0
    




â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ctfd/tests.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 3 | Size: 0

from django.test import TestCase

# Create your tests here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ctfd/urls.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 6 | Size: 0

from django.urls import path
from .views import CTFdConfigView

urlpatterns = [
    path('ctfd-config/', CTFdConfigView.as_view(), name='ctfd_config'),
]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: ctfd/views.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 20 | Size: 1.0K

from django.shortcuts import render
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from rest_framework.permissions import AllowAny , IsAuthenticated
from django.conf import settings

class CTFdConfigView(APIView):
    permission_classes = [IsAuthenticated]

    def get(self, request):
        ctfd_url = settings.CTFD_URL
        return Response({
            "success": True,
            "data": {
                "ctfd_url": ctfd_url
            }
        }, status=status.HTTP_200_OK)

# Create your views here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: dumb.sh
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 54 | Size: 4.0K

#!/bin/bash

# dump_project_files.sh - Dump all git-tracked files content into single file
# Usage: ./dump_project_files.sh [output_file]

OUTPUT_FILE="${1:-project_files_dump.txt}"

echo "ðŸš€ Dumping all $(git ls-files | wc -l) git-tracked files into '$OUTPUT_FILE'..."
echo "ðŸ“… Generated: $(date)"
echo "ðŸ“‚ Project: $(basename $(pwd))"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo

# Clear output file
> "$OUTPUT_FILE"

# Function to add file content with separator
add_file() {
    local file="$1"
    local rel_path=$(git ls-files --full-name "$file" 2>/dev/null || echo "$file")
    
    echo "ðŸ“„ FILE: $rel_path" >> "$OUTPUT_FILE"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" >> "$OUTPUT_FILE"
    echo "Lines: $(wc -l < "$file") | Size: $(du -h "$file" | cut -f1)" >> "$OUTPUT_FILE"
    echo >> "$OUTPUT_FILE"
    
    # Escape special characters and handle binary files
    if file "$file" | grep -q "text"; then
        cat "$file" >> "$OUTPUT_FILE"
    else
        echo "[BINARY/NON-TEXT FILE - $(file "$file")]" >> "$OUTPUT_FILE"
    fi
    
    echo >> "$OUTPUT_FILE"
    echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" >> "$OUTPUT_FILE"
    echo >> "$OUTPUT_FILE"
}

# Process all git-tracked files
export -f add_file
git ls-files | while read -r file; do
    if [[ -f "$file" ]]; then
        add_file "$file"
    fi
done

# Add summary
echo "âœ… Dump completed!" >> "$OUTPUT_FILE"
echo "ðŸ“Š Total files: $(git ls-files | wc -l)" >> "$OUTPUT_FILE"
echo "ðŸ’¾ Output file: $OUTPUT_FILE ($(du -h "$OUTPUT_FILE" | cut -f1))" >> "$OUTPUT_FILE"

echo "âœ… Done! Check '$OUTPUT_FILE'"
echo "ðŸ“ File size: $(du -h "$OUTPUT_FILE" | cut -f1)"
echo "ðŸ“Š Total files processed: $(git ls-files | wc -l)"

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: hackathon/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - hackathon/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: hackathon/admin.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 42 | Size: 4.0K

from django.contrib import admin
from django.http import HttpResponse
import csv
from .models import Project
from io import StringIO

@admin.register(Project)  # âœ… THIS REGISTERS IT!
class ProjectAdmin(admin.ModelAdmin):
    list_display = ('team', 'project_link', 'total_score', 'submission_time')
    list_filter = ('submission_time',)
    search_fields = ('team__team_name',)
    readonly_fields = ('submission_time',)
    ordering = ('-total_score', '-submission_time')
    
    list_editable = ('total_score',)
    
    # âœ… ACTIONS MUST BE IN actions LIST
    actions = ['reset_scores', 'export_scores_csv']  # âœ… NOW WORKS!

    @admin.action(description="ðŸ”„ Reset all scores to 0")
    def reset_scores(self, request, queryset):
        updated = queryset.update(total_score=0)
        self.message_user(request, f"Reset {updated} project(s) scores to 0", level='success')
        return

    @admin.action(description="ðŸ“Š Export selected projects to CSV")
    def export_scores_csv(self, request, queryset):
        response = HttpResponse(content_type='text/csv')
        response['Content-Disposition'] = 'attachment; filename="projects_scores.csv"'
        
        writer = csv.writer(response)
        writer.writerow(['Team', 'Project Link', 'Total Score', 'Submission Time'])
        
        for project in queryset:
            writer.writerow([
                project.team.team_name if project.team else 'No Team',
                project.project_link,
                project.total_score,
                project.submission_time
            ])
        
        return response

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: hackathon/apps.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 5 | Size: 0

from django.apps import AppConfig


class HackathonConfig(AppConfig):
    name = 'hackathon'

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: hackathon/migrations/0001_initial.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 30 | Size: 4.0K

# Generated by Django 6.0.1 on 2026-02-07 00:38

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Project',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('project_link', models.URLField(max_length=500)),
                ('submission_time', models.DateTimeField(auto_now_add=True)),
                ('total_score', models.IntegerField(default=0)),
                ('team', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='project', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-submission_time'],
            },
        ),
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: hackathon/migrations/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - hackathon/migrations/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: hackathon/models.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 18 | Size: 1.0K

from django.db import models
from teams.models import Team

class Project(models.Model):

    team = models.OneToOneField(Team, on_delete=models.CASCADE, related_name='project')
    project_link = models.URLField(max_length=500)
    submission_time = models.DateTimeField(auto_now_add=True)
    total_score = models.IntegerField(default=0)

    class Meta:
        ordering = ['-submission_time']
    
    def __str__(self):
        return f"{self.team.team_name} - {self.project_link}"


# Create your models here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: hackathon/serializers.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 23 | Size: 4.0K

# hackathon/serializers.py

from rest_framework import serializers
from .models import Project

class ProjectSerializer(serializers.ModelSerializer):
    team_name = serializers.CharField(source='team.team_name', read_only=True)
    
    class Meta:
        model = Project
        fields = ['id', 'team_name', 'project_link', 'submission_time', 'total_score']
        read_only_fields = ['id', 'team_name', 'submission_time', 'total_score']


class ProjectSubmitSerializer(serializers.ModelSerializer):
    class Meta:
        model = Project
        fields = ['project_link']
    
    def validate_project_link(self, value):
        """Ensure the URL is valid"""
        if not value.startswith(('http://', 'https://')):
            raise serializers.ValidationError("URL must start with http:// or https://")
        return value
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: hackathon/tests.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 3 | Size: 0

from django.test import TestCase

# Create your tests here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: hackathon/urls.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 7 | Size: 0

from .views import ProjectSubmitView, ProjectDetailView , AllProjectsView
from django.urls import path

urlpatterns = [
    path('submit/', ProjectSubmitView.as_view(), name='project_submit'),
    path('detail/', ProjectDetailView.as_view(), name='project_detail'),
    path('all/', AllProjectsView.as_view(), name='all_projects'),
]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: hackathon/views.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 78 | Size: 4.0K

from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from rest_framework.permissions import IsAuthenticated
from .models import Project
from .serializers import ProjectSerializer, ProjectSubmitSerializer


class ProjectSubmitView(APIView):
    """Submit or update project link"""
    permission_classes = [IsAuthenticated]

    def post(self, request):
        team = request.user
        
        # Check if project already exists for this team
        project = Project.objects.filter(team=team).first()
        
        if project:
            # Project already exists - update it
            serializer = ProjectSubmitSerializer(project, data=request.data, partial=True)
            action = "updated"
        else:
            # No project yet - create new one
            serializer = ProjectSubmitSerializer(data=request.data)
            action = "submitted"
        
        if serializer.is_valid():
            if project:
                # Update existing
                serializer.save()
            else:
                # Create new
                serializer.save(team=team)
            
            # Get the project to return full details
            project = Project.objects.get(team=team)
            
            return Response({
                "success": True,
                "message": f"Project {action} successfully",
                "data": ProjectSerializer(project).data
            }, status=status.HTTP_200_OK)
        
        return Response({
            "success": False,
            "errors": serializer.errors
        }, status=status.HTTP_400_BAD_REQUEST)

class ProjectDetailView(APIView):

    permission_classes = [IsAuthenticated]

    def get(self, request):
        team = request.user
        try:
            project = Project.objects.get(team=team)
            serializer = ProjectSerializer(project)
            return Response({
                "success": True,
                "data": serializer.data
            }, status=status.HTTP_200_OK)
        except Project.DoesNotExist:
            return Response({
                "success": False,
                "message": "No project Submitted yet"
            }, status=status.HTTP_404_NOT_FOUND)
        
class AllProjectsView(APIView):

    permission_classes = [IsAuthenticated]
    def get(self, request):
        projects = Project.objects.all()
        serializer = ProjectSerializer(projects, many=True)
        return Response({
            "success": True,
            "data": serializer.data
        }, status = status.HTTP_200_OK)
    
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: leaderboard/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - leaderboard/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: leaderboard/admin.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 3 | Size: 0

from django.contrib import admin

# Register your models here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: leaderboard/apps.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 5 | Size: 0

from django.apps import AppConfig


class LeaderboardConfig(AppConfig):
    name = 'leaderboard'

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: leaderboard/migrations/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - leaderboard/migrations/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: leaderboard/models.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 3 | Size: 0

from django.db import models

# Create your models here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: leaderboard/tests.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 3 | Size: 0

from django.test import TestCase

# Create your tests here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: leaderboard/urls.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 5 | Size: 0

from .views import LeaderboardView
from django.urls import path

urlpatterns = [
    path('leaderboard/', LeaderboardView.as_view(), name='leaderboard'),
]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: leaderboard/views.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 49 | Size: 4.0K

from django.shortcuts import render
from teams.models import Team
from ctfd.service import CTFdService
from hackathon.models import Project
from django.db.models import Sum
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from rest_framework.permissions import AllowAny , IsAuthenticated

class LeaderboardView(APIView):
    permission_classes = [AllowAny]

    def get(self, request):

        ctf_scores = CTFdService.get_team_scores()
        teams = Team.objects.filter(is_active=True,is_staff=False)

        leaderboard = []
        for team in teams:
            ctf_points = ctf_scores.get(team.ctfd_team_id,0)
            
            try :
                project = Project.objects.get(team=team)
                project_points = project.total_score
            except Project.DoesNotExist:
                project_points = 0

            token_points = team.token_submissions.aggregate(total=Sum('token__base_points'))['total'] or 0

            total_points = ctf_points + project_points + token_points
            leaderboard.append({
                "team_name":team.team_name,
                "ctf_points": ctf_points,
                "project_points": project_points,
                "token_points": token_points,
                "total_points": total_points
            })


        leaderboard.sort(key=lambda x: x['total_points'], reverse=True)
        for idx, entry in enumerate(leaderboard,start=1):
            entry['rank'] = idx
        
        return Response({
            "success": True,
            "data": leaderboard
        }, status=status.HTTP_200_OK)


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: manage.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 22 | Size: 1.0K

#!/usr/bin/env python3
"""Django's command-line utility for administrative tasks."""
import os
import sys


def main():
    """Run administrative tasks."""
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'ciconix.settings')
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == '__main__':
    main()

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: project_files_dump.txt
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 1068 | Size: 44K


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/admin.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 197 | Size: 8.0K

from asyncio.log import logger
from django.contrib import admin

from .models import SpecialPassRegistration, BasicPassRegistration
from teams.models import Team
import csv
import os
from django.conf import settings
from datetime import datetime
from teams.tasks import _update_csv_status

        
@admin.register(SpecialPassRegistration)
class SpecialPassAdmin(admin.ModelAdmin):
    list_display = ('team_name',
                     'firstname1', 'lastname1', 'discord_id1',
                     'firstname2', 'lastname2', 'discord_id2',
                     'firstname3', 'lastname3', 'discord_id3',
                     'firstname4', 'lastname4', 'discord_id4',
                     'firstname5', 'lastname5', 'discord_id5',
                     'date_joined','is_approved')
    list_filter = ['school1', 'is_approved', 'date_joined']
    search_fields = ('team_name',
                    'firstname1', 'lastname1',
                    'firstname2', 'lastname2',
                    'firstname3', 'lastname3',
                    'firstname4', 'lastname4',
                    'firstname5', 'lastname5'
                    )

    actions = ['approve_registrations' , 'reject_registrations' , 'reject_all_registrations', 'export_as_csv']
    
    

    
    def save_model(self, request, obj, form, change):
        was_approved = obj.is_approved
        super().save_model(request, obj, form, change)
    
        if obj.is_approved and not Team.objects.filter(registration=obj).exists():
            secure_password = Team.generate_secure_password()
            
            # Create Django team
            team = Team.objects.create_user(
                email=obj.email1,
                team_name=obj.team_name,
                password=secure_password
            )
            team.registration = obj
            team.save()
    
            # ðŸ”¥ TRY CTFd sync (logs everything)
            logger.info(f"ðŸ”„ Attempting CTFd sync for {team.team_name}")
            ctfd_id = team.sync_to_ctfd(secure_password)
            
            # âœ… ALWAYS save CSV backup
            self._save_password_to_csv(team.team_name, obj.email1, secure_password, ctfd_id)
            
            if ctfd_id:
                message = f"âœ… {team.team_name}\nðŸŒ CTFd ID: {ctfd_id}\nðŸ“ Password â†’ CSV"
            else:
                message = (f"âœ… {team.team_name} created + CSV saved\n"
                          f"ðŸ”„ Check Django logs for CTFd error\n"
                          f"ðŸ“‹ Use 'Retry CTFd Sync' button")
                
            self.message_user(request, message, level='success')
        
    def _save_password_to_csv(self, team_name, email, password, ctfd_id):
        """Save team credentials to CSV file"""
        # Define CSV file path (in a secure location)
        csv_dir = getattr(settings, 'TEAM_PASSWORDS_DIR', os.path.join(settings.BASE_DIR, 'secure_data'))
        os.makedirs(csv_dir, exist_ok=True)
        
        csv_file = os.path.join(csv_dir, 'team_passwords.csv')
        
        # Check if file exists to write header
        file_exists = os.path.isfile(csv_file)
        
        with open(csv_file, 'a', newline='', encoding='utf-8') as f:
            writer = csv.writer(f)
            
            # Write header if new file
            if not file_exists:
                writer.writerow([
                    'Team Name', 
                    'Email', 
                    'Password', 
                    'CTFd ID', 
                    'Created At',
                    'Status'
                ])
            
            # Write team data
            writer.writerow([
                team_name,
                email,
                password,
                ctfd_id if ctfd_id else 'PENDING',
                datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
                'Synced' if ctfd_id else 'Sync Failed'
            ])
# Add manual sync action
    @admin.action(description="ðŸ”„ Retry CTFd Sync (uses CSV passwords)")
    def retry_ctfd_sync_from_csv(self, request, queryset):
        """Retry sync for teams that failed, using CSV stored passwords"""
        import csv

        csv_dir = getattr(settings, 'TEAM_PASSWORDS_DIR', os.path.join(settings.BASE_DIR, 'secure_data'))
        csv_file = os.path.join(csv_dir, 'team_passwords.csv')

        if not os.path.exists(csv_file):
            self.message_user(request, "âŒ CSV file not found!", level='error')
            return

        # Read passwords from CSV
        password_map = {}
        with open(csv_file, 'r', newline='', encoding='utf-8') as f:
            reader = csv.DictReader(f)
            for row in reader:
                password_map[row['Team Name']] = row['Password']

        fixed = 0
        failed = []

        # ðŸ”¥ FIXED: Get TEAMS via registration (not SpecialPassRegistration!)
        for registration in queryset:
            if hasattr(registration, 'team') and registration.team:  # âœ… Check team exists
                team = registration.team
                # âœ… NOW filter on TEAM.ctfd_team_id (correct model!)
                if not team.ctfd_team_id:  # âœ… team.ctfd_team_id__isnull=True equivalent
                    if team.team_name in password_map:
                        password = password_map[team.team_name]
                        ctfd_id = team.sync_to_ctfd(password)

                        if ctfd_id:
                            fixed += 1
                            # Update CSV
                            _update_csv_status(team.team_name, ctfd_id)
                        else:
                            failed.append(team.team_name)
                    else:
                        failed.append(f"{team.team_name} (not in CSV)")
                else:
                    failed.append(f"{team.team_name} (already synced)")
            else:
                failed.append(f"{registration.team_name} (no Django team)")

        message = f"âœ… Synced {fixed} teams to CTFd!"
        if failed:
            message += f"\nâŒ Failed: {', '.join(failed[:5])}"  # Limit list length

        self.message_user(request, message, level='success' if fixed > 0 else 'warning')

    # Add this to actions list
    actions = ['approve_registrations', 'reject_registrations', 'reject_all_registrations', 
               'export_as_csv', 'retry_ctfd_sync_from_csv']    

    def approve_registrations(self, request, queryset):
        queryset.update(is_approved=True)
        self.message_user(request, "Selected registrations have been approved.")
    approve_registrations.short_description = "Approve selected registrations"

    def reject_registrations(self, request, queryset):
        queryset.update(is_approved=False)
        self.message_user(request, "Selected registrations have been rejected.")
    reject_registrations.short_description = "Reject selected registrations"

    def reject_all_registrations(self, request, queryset):
        SpecialPassRegistration.objects.update(is_approved=False)
        self.message_user(request, "All registrations have been rejected.")
    reject_all_registrations.short_description = "Reject all registrations"

    def export_as_csv(self, request, queryset):
        import csv
        from django.http import HttpResponse

        field_names = [field.name for field in SpecialPassRegistration._meta.fields]

        response = HttpResponse(content_type='text/csv')
        response['Content-Disposition'] = 'attachment; filename="special_pass_registrations.csv"'

        writer = csv.writer(response)
        writer.writerow(field_names)

        for obj in queryset:
            row = [getattr(obj, field) for field in field_names]
            writer.writerow(row)

        return response
    export_as_csv.short_description = "Export Selected as CSV"

@admin.register(BasicPassRegistration)
class BasicPassAdmin(admin.ModelAdmin):
    list_display = ('firstname', 'lastname', 'discord_id', 'date_joined','school','year','student_id')
    list_filter = ['school', 'date_joined']
    search_fields = ('firstname', 'lastname')


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/apps.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 5 | Size: 0

from django.apps import AppConfig

class RegistrationConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'registration'

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/migrations/0001_initial.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 92 | Size: 12K

# Generated by Django 6.0.1 on 2026-01-31 14:15

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='BasicPassRegistration',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('firstname', models.CharField(max_length=150, unique=True)),
                ('lastname', models.CharField(max_length=150)),
                ('school', models.CharField(choices=[('NSCS', 'National School of Cybersecurity'), ('ENSIA', 'National School of Artificial Intelligence'), ('NHSM', 'National Higher School of Mathematics'), ('NHSAST', 'National Higher School of Autonomous Systems Technology'), ('NHSNNT', 'National Higher School of Nano And Nanotechnology'), ('ESI', 'National School of Computer Science'), ('ESI-SBA', 'National School of Computer Science Sidi Bel Abbes'), ('ESTIN', 'Higher School in Computer Science and Digital Technologies'), ('NIT', 'Numidia Institute of Technology'), ('Other', 'Other')], max_length=255)),
                ('year', models.IntegerField(choices=[(1, '1st Year'), (2, '2nd Year'), (3, '3rd Year'), (4, '4th Year'), (5, '5th Year ')])),
                ('student_id', models.CharField(max_length=50, unique=True)),
                ('email', models.EmailField(max_length=254, unique=True)),
                ('discord_id', models.CharField(max_length=100, unique=True)),
                ('date_joined', models.DateTimeField(auto_now_add=True)),
            ],
        ),
        migrations.CreateModel(
            name='SpecialPassRegistration',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('firstname1', models.CharField(max_length=150, unique=True)),
                ('lastname1', models.CharField(max_length=150)),
                ('school1', models.CharField(choices=[('NSCS', 'National School of Cybersecurity'), ('ENSIA', 'National School of Artificial Intelligence'), ('NHSM', 'National Higher School of Mathematics'), ('NHSAST', 'National Higher School of Autonomous Systems Technology'), ('NHSNNT', 'National Higher School of Nano And Nanotechnology'), ('ESI', 'National School of Computer Science'), ('ESI-SBA', 'National School of Computer Science Sidi Bel Abbes'), ('ESTIN', 'Higher School in Computer Science and Digital Technologies'), ('NIT', 'Numidia Institute of Technology'), ('Other', 'Other')], max_length=255)),
                ('year1', models.IntegerField(choices=[(1, '1st Year'), (2, '2nd Year'), (3, '3rd Year'), (4, '4th Year'), (5, '5th Year ')])),
                ('student_id1', models.CharField(max_length=50, unique=True)),
                ('skills1', models.TextField(choices=[('Cryptography', 'Cryptography'), ('Web Security', 'Web Security'), ('PWN & Binary Exploitation', 'PWN & Binary Exploitation'), ('Reverse Engineering', 'Reverse Engineering'), ('Forensics', 'Forensics'), ('OSINT', 'OSINT'), ('Web Development', 'Web Development'), ('Programming', 'Programming'), ('problem Solving', 'Problem Solving'), ('Other', 'Other')], max_length=50)),
                ('profile_link1', models.URLField(blank=True, help_text='Link to your profile (GitHub, TryHackMe, CTFTime, etc.)', null=True)),
                ('email1', models.EmailField(max_length=254, unique=True)),
                ('discord_id1', models.CharField(max_length=100, unique=True)),
                ('firstname2', models.CharField(max_length=150, unique=True)),
                ('lastname2', models.CharField(max_length=150)),
                ('school2', models.CharField(choices=[('NSCS', 'National School of Cybersecurity'), ('ENSIA', 'National School of Artificial Intelligence'), ('NHSM', 'National Higher School of Mathematics'), ('NHSAST', 'National Higher School of Autonomous Systems Technology'), ('NHSNNT', 'National Higher School of Nano And Nanotechnology'), ('ESI', 'National School of Computer Science'), ('ESI-SBA', 'National School of Computer Science Sidi Bel Abbes'), ('ESTIN', 'Higher School in Computer Science and Digital Technologies'), ('NIT', 'Numidia Institute of Technology'), ('Other', 'Other')], max_length=255)),
                ('year2', models.IntegerField(choices=[(1, '1st Year'), (2, '2nd Year'), (3, '3rd Year'), (4, '4th Year'), (5, '5th Year ')])),
                ('student_id2', models.CharField(max_length=50, unique=True)),
                ('skills2', models.TextField(choices=[('Cryptography', 'Cryptography'), ('Web Security', 'Web Security'), ('PWN & Binary Exploitation', 'PWN & Binary Exploitation'), ('Reverse Engineering', 'Reverse Engineering'), ('Forensics', 'Forensics'), ('OSINT', 'OSINT'), ('Web Development', 'Web Development'), ('Programming', 'Programming'), ('problem Solving', 'Problem Solving'), ('Other', 'Other')], max_length=50)),
                ('profile_link2', models.URLField(blank=True, help_text='Link to your profile (GitHub, TryHackMe, CTFTime, etc.)', null=True)),
                ('email2', models.EmailField(max_length=254, unique=True)),
                ('discord_id2', models.CharField(max_length=100, unique=True)),
                ('firstname3', models.CharField(max_length=150, unique=True)),
                ('lastname3', models.CharField(max_length=150)),
                ('school3', models.CharField(choices=[('NSCS', 'National School of Cybersecurity'), ('ENSIA', 'National School of Artificial Intelligence'), ('NHSM', 'National Higher School of Mathematics'), ('NHSAST', 'National Higher School of Autonomous Systems Technology'), ('NHSNNT', 'National Higher School of Nano And Nanotechnology'), ('ESI', 'National School of Computer Science'), ('ESI-SBA', 'National School of Computer Science Sidi Bel Abbes'), ('ESTIN', 'Higher School in Computer Science and Digital Technologies'), ('NIT', 'Numidia Institute of Technology'), ('Other', 'Other')], max_length=255)),
                ('year3', models.IntegerField(choices=[(1, '1st Year'), (2, '2nd Year'), (3, '3rd Year'), (4, '4th Year'), (5, '5th Year ')])),
                ('student_id3', models.CharField(max_length=50, unique=True)),
                ('skills3', models.TextField(choices=[('Cryptography', 'Cryptography'), ('Web Security', 'Web Security'), ('PWN & Binary Exploitation', 'PWN & Binary Exploitation'), ('Reverse Engineering', 'Reverse Engineering'), ('Forensics', 'Forensics'), ('OSINT', 'OSINT'), ('Web Development', 'Web Development'), ('Programming', 'Programming'), ('problem Solving', 'Problem Solving'), ('Other', 'Other')], max_length=50)),
                ('profile_link3', models.URLField(blank=True, help_text='Link to your profile (GitHub, TryHackMe, CTFTime, etc.)', null=True)),
                ('email3', models.EmailField(max_length=254, unique=True)),
                ('discord_id3', models.CharField(max_length=100, unique=True)),
                ('firstname4', models.CharField(max_length=150, unique=True)),
                ('lastname4', models.CharField(max_length=150)),
                ('school4', models.CharField(choices=[('NSCS', 'National School of Cybersecurity'), ('ENSIA', 'National School of Artificial Intelligence'), ('NHSM', 'National Higher School of Mathematics'), ('NHSAST', 'National Higher School of Autonomous Systems Technology'), ('NHSNNT', 'National Higher School of Nano And Nanotechnology'), ('ESI', 'National School of Computer Science'), ('ESI-SBA', 'National School of Computer Science Sidi Bel Abbes'), ('ESTIN', 'Higher School in Computer Science and Digital Technologies'), ('NIT', 'Numidia Institute of Technology'), ('Other', 'Other')], max_length=255)),
                ('year4', models.IntegerField(choices=[(1, '1st Year'), (2, '2nd Year'), (3, '3rd Year'), (4, '4th Year'), (5, '5th Year ')])),
                ('student_id4', models.CharField(max_length=50, unique=True)),
                ('skills4', models.TextField(choices=[('Cryptography', 'Cryptography'), ('Web Security', 'Web Security'), ('PWN & Binary Exploitation', 'PWN & Binary Exploitation'), ('Reverse Engineering', 'Reverse Engineering'), ('Forensics', 'Forensics'), ('OSINT', 'OSINT'), ('Web Development', 'Web Development'), ('Programming', 'Programming'), ('problem Solving', 'Problem Solving'), ('Other', 'Other')], max_length=50)),
                ('profile_link4', models.URLField(blank=True, help_text='Link to your profile (GitHub, TryHackMe, CTFTime, etc.)', null=True)),
                ('email4', models.EmailField(max_length=254, unique=True)),
                ('discord_id4', models.CharField(max_length=100, unique=True)),
                ('firstname5', models.CharField(max_length=150, unique=True)),
                ('lastname5', models.CharField(max_length=150)),
                ('school5', models.CharField(choices=[('NSCS', 'National School of Cybersecurity'), ('ENSIA', 'National School of Artificial Intelligence'), ('NHSM', 'National Higher School of Mathematics'), ('NHSAST', 'National Higher School of Autonomous Systems Technology'), ('NHSNNT', 'National Higher School of Nano And Nanotechnology'), ('ESI', 'National School of Computer Science'), ('ESI-SBA', 'National School of Computer Science Sidi Bel Abbes'), ('ESTIN', 'Higher School in Computer Science and Digital Technologies'), ('NIT', 'Numidia Institute of Technology'), ('Other', 'Other')], max_length=255)),
                ('year5', models.IntegerField(choices=[(1, '1st Year'), (2, '2nd Year'), (3, '3rd Year'), (4, '4th Year'), (5, '5th Year ')])),
                ('student_id5', models.CharField(max_length=50, unique=True)),
                ('skills5', models.TextField(choices=[('Cryptography', 'Cryptography'), ('Web Security', 'Web Security'), ('PWN & Binary Exploitation', 'PWN & Binary Exploitation'), ('Reverse Engineering', 'Reverse Engineering'), ('Forensics', 'Forensics'), ('OSINT', 'OSINT'), ('Web Development', 'Web Development'), ('Programming', 'Programming'), ('problem Solving', 'Problem Solving'), ('Other', 'Other')], max_length=50)),
                ('profile_link5', models.URLField(blank=True, help_text='Link to your profile (GitHub, TryHackMe, CTFTime, etc.)', null=True)),
                ('email5', models.EmailField(max_length=254, unique=True)),
                ('discord_id5', models.CharField(max_length=100, unique=True)),
                ('team_name', models.CharField(max_length=150, unique=True)),
                ('is_approved', models.BooleanField(default=False, help_text='Admin approves for competition')),
                ('date_joined', models.DateTimeField(auto_now_add=True)),
            ],
        ),
        migrations.CreateModel(
            name='Team',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('team_name', models.CharField(max_length=150, unique=True)),
                ('ctfd_team_id', models.IntegerField(blank=True, null=True, unique=True)),
                ('registration', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='teams', to='registration.specialpassregistration')),
            ],
        ),
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/migrations/0002_delete_team.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 16 | Size: 0

# Generated by Django 6.0.1 on 2026-01-31 18:14

from django.db import migrations


class Migration(migrations.Migration):

    dependencies = [
        ('registration', '0001_initial'),
    ]

    operations = [
        migrations.DeleteModel(
            name='Team',
        ),
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/migrations/0003_alter_basicpassregistration_firstname_and_more.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 43 | Size: 4.0K

# Generated by Django 6.0.1 on 2026-02-05 18:11

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('registration', '0002_delete_team'),
    ]

    operations = [
        migrations.AlterField(
            model_name='basicpassregistration',
            name='firstname',
            field=models.CharField(max_length=150),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='firstname1',
            field=models.CharField(max_length=150),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='firstname2',
            field=models.CharField(max_length=150),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='firstname3',
            field=models.CharField(max_length=150),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='firstname4',
            field=models.CharField(max_length=150),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='firstname5',
            field=models.CharField(max_length=150),
        ),
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/migrations/0004_alter_specialpassregistration_discord_id4_and_more.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 93 | Size: 8.0K

# Generated by Django 6.0.1 on 2026-02-08 12:45

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('registration', '0003_alter_basicpassregistration_firstname_and_more'),
    ]

    operations = [
        migrations.AlterField(
            model_name='specialpassregistration',
            name='discord_id4',
            field=models.CharField(blank=True, max_length=100, null=True, unique=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='discord_id5',
            field=models.CharField(blank=True, max_length=100, null=True, unique=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='email4',
            field=models.EmailField(blank=True, max_length=254, null=True, unique=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='email5',
            field=models.EmailField(blank=True, max_length=254, null=True, unique=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='firstname4',
            field=models.CharField(blank=True, max_length=150, null=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='firstname5',
            field=models.CharField(blank=True, max_length=150, null=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='lastname4',
            field=models.CharField(blank=True, max_length=150, null=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='lastname5',
            field=models.CharField(blank=True, max_length=150, null=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='school4',
            field=models.CharField(blank=True, choices=[('NSCS', 'National School of Cybersecurity'), ('ENSIA', 'National School of Artificial Intelligence'), ('NHSM', 'National Higher School of Mathematics'), ('NHSAST', 'National Higher School of Autonomous Systems Technology'), ('NHSNNT', 'National Higher School of Nano And Nanotechnology'), ('ESI', 'National School of Computer Science'), ('ESI-SBA', 'National School of Computer Science Sidi Bel Abbes'), ('ESTIN', 'Higher School in Computer Science and Digital Technologies'), ('NIT', 'Numidia Institute of Technology'), ('Other', 'Other')], max_length=255, null=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='school5',
            field=models.CharField(blank=True, choices=[('NSCS', 'National School of Cybersecurity'), ('ENSIA', 'National School of Artificial Intelligence'), ('NHSM', 'National Higher School of Mathematics'), ('NHSAST', 'National Higher School of Autonomous Systems Technology'), ('NHSNNT', 'National Higher School of Nano And Nanotechnology'), ('ESI', 'National School of Computer Science'), ('ESI-SBA', 'National School of Computer Science Sidi Bel Abbes'), ('ESTIN', 'Higher School in Computer Science and Digital Technologies'), ('NIT', 'Numidia Institute of Technology'), ('Other', 'Other')], max_length=255, null=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='skills4',
            field=models.TextField(blank=True, choices=[('Cryptography', 'Cryptography'), ('Web Security', 'Web Security'), ('PWN & Binary Exploitation', 'PWN & Binary Exploitation'), ('Reverse Engineering', 'Reverse Engineering'), ('Forensics', 'Forensics'), ('OSINT', 'OSINT'), ('Web Development', 'Web Development'), ('Programming', 'Programming'), ('problem Solving', 'Problem Solving'), ('Other', 'Other')], max_length=50, null=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='skills5',
            field=models.TextField(blank=True, choices=[('Cryptography', 'Cryptography'), ('Web Security', 'Web Security'), ('PWN & Binary Exploitation', 'PWN & Binary Exploitation'), ('Reverse Engineering', 'Reverse Engineering'), ('Forensics', 'Forensics'), ('OSINT', 'OSINT'), ('Web Development', 'Web Development'), ('Programming', 'Programming'), ('problem Solving', 'Problem Solving'), ('Other', 'Other')], max_length=50, null=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='student_id4',
            field=models.CharField(blank=True, max_length=50, null=True, unique=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='student_id5',
            field=models.CharField(blank=True, max_length=50, null=True, unique=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='year4',
            field=models.IntegerField(blank=True, choices=[(1, '1st Year'), (2, '2nd Year'), (3, '3rd Year'), (4, '4th Year'), (5, '5th Year ')], null=True),
        ),
        migrations.AlterField(
            model_name='specialpassregistration',
            name='year5',
            field=models.IntegerField(blank=True, choices=[(1, '1st Year'), (2, '2nd Year'), (3, '3rd Year'), (4, '4th Year'), (5, '5th Year ')], null=True),
        ),
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/migrations/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 1 | Size: 0

default_app_config = 'registration.apps.RegistrationConfig'

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/models.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 142 | Size: 8.0K

# registration/models.py

from django.db import models
from django.conf import settings

class SpecialPassRegistration(models.Model):  

    Year_Choices = [
        (1, '1st Year'),
        (2, '2nd Year'),
        (3, '3rd Year'),
        (4, '4th Year'),
        (5, '5th Year '),
    ]

    School_Choices = [
        ('NSCS', 'National School of Cybersecurity'),
        ('ENSIA', 'National School of Artificial Intelligence'),
        ('NHSM', 'National Higher School of Mathematics'),
        ('NHSAST', 'National Higher School of Autonomous Systems Technology'),
        ('NHSNNT', 'National Higher School of Nano And Nanotechnology'),
        ('ESI', 'National School of Computer Science'),
        ('ESI-SBA', 'National School of Computer Science Sidi Bel Abbes'),
        ('ESTIN','Higher School in Computer Science and Digital Technologies'),
        ('NIT', 'Numidia Institute of Technology'),
        ('Other', 'Other'),
    ]

    Skills_Choices = [
        ('Cryptography', 'Cryptography'),
        ('Web Security', 'Web Security'),
        ('PWN & Binary Exploitation', 'PWN & Binary Exploitation'),
        ('Reverse Engineering', 'Reverse Engineering'),
        ('Forensics', 'Forensics'),
        ('OSINT', 'OSINT'),
        ('Web Development', 'Web Development'),
        ('Programming', 'Programming'),
        ('problem Solving', 'Problem Solving'),
        ('Other', 'Other'),
    ]

    # Team Leader Information (REQUIRED)
    firstname1 = models.CharField(max_length=150) 
    lastname1 = models.CharField(max_length=150)
    school1 = models.CharField(max_length=255, choices=School_Choices)
    year1 = models.IntegerField(choices=Year_Choices)
    student_id1 = models.CharField(max_length=50, unique=True)
    skills1 = models.TextField(max_length=50, choices=Skills_Choices)
    profile_link1 = models.URLField(blank=True, null=True, help_text="Link to your profile (GitHub, TryHackMe, CTFTime, etc.)")
    email1 = models.EmailField(unique=True)
    discord_id1 = models.CharField(max_length=100, unique=True)

    # Second Team member Information (REQUIRED)
    firstname2 = models.CharField(max_length=150) 
    lastname2 = models.CharField(max_length=150)
    school2 = models.CharField(max_length=255, choices=School_Choices)
    year2 = models.IntegerField(choices=Year_Choices)
    student_id2 = models.CharField(max_length=50, unique=True)
    skills2 = models.TextField(max_length=50, choices=Skills_Choices)
    profile_link2 = models.URLField(blank=True, null=True, help_text="Link to your profile (GitHub, TryHackMe, CTFTime, etc.)")
    email2 = models.EmailField(unique=True)
    discord_id2 = models.CharField(max_length=100, unique=True)

    # Third Team member Information (REQUIRED)
    firstname3 = models.CharField(max_length=150) 
    lastname3 = models.CharField(max_length=150)
    school3 = models.CharField(max_length=255, choices=School_Choices)
    year3 = models.IntegerField(choices=Year_Choices)
    student_id3 = models.CharField(max_length=50, unique=True)
    skills3 = models.TextField(max_length=50, choices=Skills_Choices)
    profile_link3 = models.URLField(blank=True, null=True, help_text="Link to your profile (GitHub, TryHackMe, CTFTime, etc.)")
    email3 = models.EmailField(unique=True)
    discord_id3 = models.CharField(max_length=100, unique=True)

    # Fourth Team member Information (OPTIONAL) âœ…
    firstname4 = models.CharField(max_length=150, blank=True, null=True)  # âœ… Optional
    lastname4 = models.CharField(max_length=150, blank=True, null=True)
    school4 = models.CharField(max_length=255, choices=School_Choices, blank=True, null=True)
    year4 = models.IntegerField(choices=Year_Choices, blank=True, null=True)
    student_id4 = models.CharField(max_length=50, unique=True, blank=True, null=True)
    skills4 = models.TextField(max_length=50, choices=Skills_Choices, blank=True, null=True)
    profile_link4 = models.URLField(blank=True, null=True, help_text="Link to your profile (GitHub, TryHackMe, CTFTime, etc.)")
    email4 = models.EmailField(unique=True, blank=True, null=True)
    discord_id4 = models.CharField(max_length=100, unique=True, blank=True, null=True)

    # Fifth Team member Information (OPTIONAL) âœ…
    firstname5 = models.CharField(max_length=150, blank=True, null=True)  # âœ… Optional
    lastname5 = models.CharField(max_length=150, blank=True, null=True)
    school5 = models.CharField(max_length=255, choices=School_Choices, blank=True, null=True)
    year5 = models.IntegerField(choices=Year_Choices, blank=True, null=True)
    student_id5 = models.CharField(max_length=50, unique=True, blank=True, null=True)
    skills5 = models.TextField(max_length=50, choices=Skills_Choices, blank=True, null=True)
    profile_link5 = models.URLField(blank=True, null=True, help_text="Link to your profile (GitHub, TryHackMe, CTFTime, etc.)")
    email5 = models.EmailField(unique=True, blank=True, null=True)
    discord_id5 = models.CharField(max_length=100, unique=True, blank=True, null=True)

    # Team Information
    team_name = models.CharField(max_length=150, unique=True)
    is_approved = models.BooleanField(default=False, help_text="Admin approves for competition")

    # Date Joined
    date_joined = models.DateTimeField(auto_now_add=True)    

    def __str__(self):
        return self.team_name + " - " + self.firstname1 + " " + self.lastname1
    
class BasicPassRegistration(models.Model):
    
    Year_Choices = [
        (1, '1st Year'),
        (2, '2nd Year'),
        (3, '3rd Year'),
        (4, '4th Year'),
        (5, '5th Year '),
    ]

    School_Choices = [
        ('NSCS', 'National School of Cybersecurity'),
        ('ENSIA', 'National School of Artificial Intelligence'),
        ('NHSM', 'National Higher School of Mathematics'),
        ('NHSAST', 'National Higher School of Autonomous Systems Technology'),
        ('NHSNNT', 'National Higher School of Nano And Nanotechnology'),
        ('ESI', 'National School of Computer Science'),
        ('ESI-SBA', 'National School of Computer Science Sidi Bel Abbes'),
        ('ESTIN','Higher School in Computer Science and Digital Technologies'),
        ('NIT', 'Numidia Institute of Technology'),
        ('Other', 'Other'),
    ]

    # Team Leader Information
    firstname = models.CharField(max_length=150) 
    lastname = models.CharField(max_length=150)
    school = models.CharField(max_length=255 , choices=School_Choices)
    year = models.IntegerField(choices=Year_Choices)
    student_id = models.CharField(max_length=50, unique=True)
    email = models.EmailField(unique=True)
    discord_id = models.CharField(max_length=100, unique=True)
    date_joined = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.firstname + " " + self.lastname
    

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/serializers.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 198 | Size: 12K

# registration/serializers.py

from .models import SpecialPassRegistration, BasicPassRegistration 
from rest_framework import serializers


class BasicPassRegistrationSerializer(serializers.ModelSerializer):
    class Meta:
        model = BasicPassRegistration
        fields = '__all__'
        read_only_fields = ['date_joined']
        
    def validate_email(self, value):
        value = value.lower()
        if BasicPassRegistration.objects.filter(email__iexact=value).exists():
            raise serializers.ValidationError(
                "This email is already registered for the Basic Pass!"
            )
        return value
    
    def validate_student_id(self, value):
        value = value.upper()
        if BasicPassRegistration.objects.filter(student_id__iexact=value).exists():
            raise serializers.ValidationError(
                "This Student ID is already registered for the Basic Pass!"
            )
        return value
    
    def validate_discord_id(self, value):
        if BasicPassRegistration.objects.filter(discord_id__iexact=value).exists():
            raise serializers.ValidationError(
                "This Discord ID is already registered for the Basic Pass!"
            )
        return value


class SpecialPassRegistrationSerializer(serializers.ModelSerializer):
    class Meta:
        model = SpecialPassRegistration
        fields = '__all__'
        read_only_fields = ['is_approved', 'date_joined']
    
    # Validation for members 1-5 (email, student_id, discord_id)
    def validate_email1(self, value):
        value = value.lower()
        if SpecialPassRegistration.objects.filter(email1__iexact=value).exists():
            raise serializers.ValidationError("This email is already registered!")
        return value
    
    def validate_student_id1(self, value):
        value = value.upper()
        if SpecialPassRegistration.objects.filter(student_id1__iexact=value).exists():
            raise serializers.ValidationError("This Student ID is already registered!")
        return value
    
    def validate_discord_id1(self, value):
        if SpecialPassRegistration.objects.filter(discord_id1__iexact=value).exists():
            raise serializers.ValidationError("This Discord ID is already registered!")
        return value

    def validate_email2(self, value):
        value = value.lower()
        if SpecialPassRegistration.objects.filter(email2__iexact=value).exists():
            raise serializers.ValidationError("This email is already registered!")
        return value
    
    def validate_student_id2(self, value):
        value = value.upper()
        if SpecialPassRegistration.objects.filter(student_id2__iexact=value).exists():
            raise serializers.ValidationError("This Student ID is already registered!")
        return value
    
    def validate_discord_id2(self, value):
        if SpecialPassRegistration.objects.filter(discord_id2__iexact=value).exists():
            raise serializers.ValidationError("This Discord ID is already registered!")
        return value

    def validate_email3(self, value):
        value = value.lower()
        if SpecialPassRegistration.objects.filter(email3__iexact=value).exists():
            raise serializers.ValidationError("This email is already registered!")
        return value
    
    def validate_student_id3(self, value):
        value = value.upper()
        if SpecialPassRegistration.objects.filter(student_id3__iexact=value).exists():
            raise serializers.ValidationError("This Student ID is already registered!")
        return value
    
    def validate_discord_id3(self, value):
        if SpecialPassRegistration.objects.filter(discord_id3__iexact=value).exists():
            raise serializers.ValidationError("This Discord ID is already registered!")
        return value

    def validate_email4(self, value):
        if value:  # âœ… Only validate if provided
            value = value.lower()
            if SpecialPassRegistration.objects.filter(email4__iexact=value).exists():
                raise serializers.ValidationError("This email is already registered!")
        return value
    
    def validate_student_id4(self, value):
        if value:  # âœ… Only validate if provided
            value = value.upper()
            if SpecialPassRegistration.objects.filter(student_id4__iexact=value).exists():
                raise serializers.ValidationError("This Student ID is already registered!")
        return value
    
    def validate_discord_id4(self, value):
        if value:  # âœ… Only validate if provided
            if SpecialPassRegistration.objects.filter(discord_id4__iexact=value).exists():
                raise serializers.ValidationError("This Discord ID is already registered!")
        return value

    def validate_email5(self, value):
        if value:  # âœ… Only validate if provided
            value = value.lower()
            if SpecialPassRegistration.objects.filter(email5__iexact=value).exists():
                raise serializers.ValidationError("This email is already registered!")
        return value
    
    def validate_student_id5(self, value):
        if value:  # âœ… Only validate if provided
            value = value.upper()
            if SpecialPassRegistration.objects.filter(student_id5__iexact=value).exists():
                raise serializers.ValidationError("This Student ID is already registered!")
        return value
    
    def validate_discord_id5(self, value):
        if value:  # âœ… Only validate if provided
            if SpecialPassRegistration.objects.filter(discord_id5__iexact=value).exists():
                raise serializers.ValidationError("This Discord ID is already registered!")
        return value

    def validate(self, data):
        """
        Custom validation:
        1. Members 1-3 are REQUIRED
        2. Members 4-5 are OPTIONAL, but if ANY field is provided, ALL required fields must be provided
        3. Check for duplicate emails, student_ids, and discord_ids within the team
        """
        
        # âœ… Check if member 4 is partially filled
        member4_fields = ['firstname4', 'lastname4', 'school4', 'year4', 
                         'student_id4', 'skills4', 'email4', 'discord_id4']
        member4_provided = [field for field in member4_fields if data.get(field)]
        
        if member4_provided:
            # If any field is provided, ALL required fields must be present
            required_member4 = ['firstname4', 'lastname4', 'school4', 'year4', 
                               'student_id4', 'skills4', 'email4', 'discord_id4']
            missing_fields = [f for f in required_member4 if not data.get(f)]
            
            if missing_fields:
                raise serializers.ValidationError({
                    "member4": f"If providing 4th member info, all required fields must be filled. Missing: {', '.join(missing_fields)}"
                })
        
        # âœ… Check if member 5 is partially filled
        member5_fields = ['firstname5', 'lastname5', 'school5', 'year5', 
                         'student_id5', 'skills5', 'email5', 'discord_id5']
        member5_provided = [field for field in member5_fields if data.get(field)]
        
        if member5_provided:
            # If any field is provided, ALL required fields must be present
            required_member5 = ['firstname5', 'lastname5', 'school5', 'year5', 
                               'student_id5', 'skills5', 'email5', 'discord_id5']
            missing_fields = [f for f in required_member5 if not data.get(f)]
            
            if missing_fields:
                raise serializers.ValidationError({
                    "member5": f"If providing 5th member info, all required fields must be filled. Missing: {', '.join(missing_fields)}"
                })

        # âœ… Check for duplicates within the team
        all_emails = []
        all_student_ids = []
        all_discord_ids = []

        for i in range(1, 6):
            email = data.get(f'email{i}')
            student_id = data.get(f'student_id{i}')
            discord_id = data.get(f'discord_id{i}')

            if email:
                all_emails.append(email.lower())
            if student_id:
                all_student_ids.append(student_id.upper())
            if discord_id:
                all_discord_ids.append(discord_id)

        if len(all_emails) != len(set(all_emails)):
            raise serializers.ValidationError("All team members must have unique email addresses.")
        if len(all_student_ids) != len(set(all_student_ids)):
            raise serializers.ValidationError("All team members must have unique Student IDs.")
        if len(all_discord_ids) != len(set(all_discord_ids)):
            raise serializers.ValidationError("All team members must have unique Discord IDs.")
        
        return data
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/tests.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 3 | Size: 0

from django.test import TestCase

# Create your tests here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/urls.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 7 | Size: 0

from django.urls import path
from .views import BasicPassRegistrationView , SpecialPassRegistrationView

urlpatterns = [
    path('basic-pass/', BasicPassRegistrationView.as_view(), name='basic_pass_registration'),
    path('special-pass/', SpecialPassRegistrationView.as_view(), name='special_pass_registration'),
]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: registration/views.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 41 | Size: 4.0K

from django.shortcuts import render
from django.http import HttpResponse
from .models import SpecialPassRegistration, BasicPassRegistration
from .serializers import BasicPassRegistrationSerializer , SpecialPassRegistrationSerializer
from rest_framework import status
from rest_framework.response import Response
from rest_framework.views import APIView
from rest_framework.permissions import AllowAny

class BasicPassRegistrationView(APIView):
    
    permission_classes = [AllowAny]

    def post(self, request):
        serializer = BasicPassRegistrationSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response({
                "Success": True,
                "message": "Basic Pass Registration successful",
                "data": serializer.data},
                status=status.HTTP_201_CREATED)
        return Response({"errors": serializer.errors}, status=status.HTTP_400_BAD_REQUEST)
        
class SpecialPassRegistrationView(APIView):

    permission_classes = [AllowAny]

    def post(self, request):
        serializer = SpecialPassRegistrationSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response({
                "Success": True,
                "message": "Special Pass Registration successful",
                "data": serializer.data},
                status=status.HTTP_201_CREATED)
        return Response({"errors": serializer.errors}, status=status.HTTP_400_BAD_REQUEST)


# Create your views here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: requirements.txt
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 37 | Size: 4.0K

amqp==5.3.1
asgiref==3.11.0
billiard==4.2.4
celery==5.6.2
certifi==2026.1.4
charset-normalizer==3.4.4
click==8.3.1
click-didyoumean==0.3.1
click-plugins==1.1.1.2
click-repl==0.3.0
dj-database-url==3.1.0
Django==6.0.1
django-cors-headers==4.9.0
django-ratelimit==4.1.0
django-redis==6.0.0
djangorestframework==3.16.1
djangorestframework_simplejwt==5.5.1
gunicorn==25.0.1
idna==3.11
kombu==5.6.2
packaging==26.0
prompt_toolkit==3.0.52
psycopg2-binary==2.9.11
PyJWT==2.11.0
python-dateutil==2.9.0.post0
python-decouple==3.8
python-dotenv==1.2.1
redis==7.1.1
requests==2.32.5
six==1.17.0
sqlparse==0.5.5
tzdata==2025.3
tzlocal==5.3.1
urllib3==2.6.3
vine==5.1.0
wcwidth==0.5.3
whitenoise==6.11.0

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - teams/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/admin.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 21 | Size: 4.0K

from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from .models import Team

@admin.register(Team)
class TeamAdmin(UserAdmin):
    list_display = ('email', 'team_name', 'is_staff', 'is_active', 'ctfd_team_id')
    list_filter = ('is_staff', 'is_active', 'is_superuser')
    fieldsets = (
        (None, {'fields': ('email', 'password')}),
        ('Team Info', {'fields': ('team_name', 'ctfd_team_id')}),
        ('Permissions', {'fields': ('is_active', 'is_staff', 'is_superuser', 'groups', 'user_permissions')}),
    )
    add_fieldsets = (
        (None, {
            'classes': ('wide',),
            'fields': ('email', 'team_name', 'password1', 'password2'),
        }),
    )
    search_fields = ('email', 'team_name')
    ordering = ('email',)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/apps.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 5 | Size: 0

from django.apps import AppConfig


class TeamsConfig(AppConfig):
    name = 'teams'

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/migrations/0001_initial.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 25 | Size: 4.0K

# Generated by Django 6.0.1 on 2026-01-31 18:14

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('registration', '0002_delete_team'),
    ]

    operations = [
        migrations.CreateModel(
            name='Team',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('team_name', models.CharField(max_length=150, unique=True)),
                ('ctfd_team_id', models.IntegerField(blank=True, null=True, unique=True)),
                ('registration', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='teams', to='registration.specialpassregistration')),
            ],
        ),
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/migrations/0002_auto_20260131_1831.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 13 | Size: 0

# Generated by Django 6.0.1 on 2026-01-31 18:31

from django.db import migrations


class Migration(migrations.Migration):

    dependencies = [
        ('teams', '0001_initial'),
    ]

    operations = [
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/migrations/0003_team_created_at_alter_team_ctfd_team_id_and_more.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 32 | Size: 4.0K

# Generated by Django 6.0.1 on 2026-01-31 18:41

import django.db.models.deletion
import django.utils.timezone
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('registration', '0002_delete_team'),
        ('teams', '0002_auto_20260131_1831'),
    ]

    operations = [
        migrations.AddField(
            model_name='team',
            name='created_at',
            field=models.DateTimeField(auto_now_add=True, default=django.utils.timezone.now),
            preserve_default=False,
        ),
        migrations.AlterField(
            model_name='team',
            name='ctfd_team_id',
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AlterField(
            model_name='team',
            name='registration',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='team', to='registration.specialpassregistration'),
        ),
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/migrations/0004_team_email_team_groups_team_is_active_team_is_staff_and_more.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 64 | Size: 4.0K

# Generated by Django 6.0.1 on 2026-02-04 00:15

import django.db.models.deletion
import django.utils.timezone
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
        ('registration', '0002_delete_team'),
        ('teams', '0003_team_created_at_alter_team_ctfd_team_id_and_more'),
    ]

    operations = [
        migrations.AddField(
            model_name='team',
            name='email',
            field=models.EmailField(default=django.utils.timezone.now, max_length=254, unique=True),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='team',
            name='groups',
            field=models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups'),
        ),
        migrations.AddField(
            model_name='team',
            name='is_active',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='team',
            name='is_staff',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='team',
            name='is_superuser',
            field=models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status'),
        ),
        migrations.AddField(
            model_name='team',
            name='last_login',
            field=models.DateTimeField(blank=True, null=True, verbose_name='last login'),
        ),
        migrations.AddField(
            model_name='team',
            name='password',
            field=models.CharField(default=django.utils.timezone.now, max_length=128, verbose_name='password'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='team',
            name='user_permissions',
            field=models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions'),
        ),
        migrations.AlterField(
            model_name='team',
            name='registration',
            field=models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='team', to='registration.specialpassregistration'),
        ),
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/migrations/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - teams/migrations/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/models.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 151 | Size: 8.0K

from django.db import models
from django.contrib.auth.models import AbstractBaseUser, BaseUserManager, PermissionsMixin
from django.conf import settings
import requests
import secrets
import string
import logging
import time

logger = logging.getLogger(__name__)

class TeamManager(BaseUserManager):
    def create_user(self, email, team_name, password=None, **extra_fields):
        if not email:
            raise ValueError("Teams must have an email address")
        
        email = self.normalize_email(email)
        team = self.model(email=email, team_name=team_name, **extra_fields)
        
        if password:
            team.set_password(password)  # âœ… Securely hashes password
        
        team.save(using=self._db)
        return team

    def create_superuser(self, email, team_name, password=None, **extra_fields):
        extra_fields.setdefault('is_staff', True)
        extra_fields.setdefault('is_superuser', True)
        extra_fields.setdefault('is_active', True)

        if extra_fields.get('is_staff') is not True:
            raise ValueError('Superuser must have is_staff=True.')
        if extra_fields.get('is_superuser') is not True:
            raise ValueError('Superuser must have is_superuser=True.')

        return self.create_user(email, team_name, password, **extra_fields)

class Team(AbstractBaseUser, PermissionsMixin):
    team_name = models.CharField(max_length=150, unique=True)
    email = models.EmailField(unique=True)  # âœ… Login field
    
    registration = models.OneToOneField(
        'registration.SpecialPassRegistration',
        on_delete=models.CASCADE,
        related_name='team',
        null=True, blank=True
    )
    
    ctfd_team_id = models.IntegerField(null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
    
    # âœ… REQUIRED Django auth fields
    is_active = models.BooleanField(default=True)
    is_staff = models.BooleanField(default=False)

    objects = TeamManager()

    USERNAME_FIELD = 'email'
    REQUIRED_FIELDS = ['team_name']

    # âœ… REQUIRED: Django needs these methods
    def get_full_name(self):
        return self.team_name

    def get_short_name(self):
        return self.team_name

    def __str__(self):
        return self.team_name

    # âœ… Secure random password generator
    @classmethod
    def generate_secure_password(cls, length=16):
        """Generate secure random password"""
        alphabet = string.ascii_letters + string.digits + "!@#$%^&*"
        password = ''.join(secrets.choice(alphabet) for _ in range(length))
        return password

    def sync_to_ctfd(self, password):
        """âœ… PRODUCTION-READY CTFd sync - handles YOUR exact token"""
        
        ctfd_url = getattr(settings, 'CTFD_URL', 'http://localhost:8001').rstrip('/')
        ctfd_token = getattr(settings, 'CTFD_API_TOKEN', '')
        
        if not ctfd_token:
            logger.error("âŒ CTFD_API_TOKEN missing")
            return None
        
        headers = {
            'Authorization': f'Token {ctfd_token}',  # âœ… YOUR exact format
            'Content-Type': 'application/json'
        }
        
        # ðŸ”¥ STEP 1: CREATE TEAM
        try:
            create_payload = {
                'name': self.team_name,
                'password': password,
                'captain_id': None
            }
            
            logger.info(f"ðŸ”„ Creating {self.team_name} in CTFd...")
            create_resp = requests.post(
                f'{ctfd_url}/api/v1/teams',
                json=create_payload,
                headers=headers,
                timeout=15  # Increased timeout
            )
            
            logger.info(f"CTFd CREATE {self.team_name}: {create_resp.status_code}")
            logger.info(f"Response: {create_resp.text[:200]}...")
            
            if create_resp.status_code in [200, 201]:
                ctfd_data = create_resp.json()
                self.ctfd_team_id = ctfd_data['data']['id']
                self.save(update_fields=['ctfd_team_id'])
                logger.info(f"âœ… {self.team_name} CREATED: CTFd ID {self.ctfd_team_id}")
                return self.ctfd_team_id
                
        except requests.exceptions.RequestException as e:
            logger.error(f"âŒ CTFd network error: {e}")
        except Exception as e:
            logger.error(f"âŒ CTFd parse error: {e}")
        
        # ðŸ”¥ STEP 2: LOOKUP if create failed (3 retries)
        for attempt in range(3):
            try:
                logger.info(f"ðŸ” Lookup attempt {attempt+1} for {self.team_name}")
                lookup_resp = requests.get(
                    f'{ctfd_url}/api/v1/teams?name={self.team_name}',
                    headers=headers,
                    timeout=10
                )
                
                if lookup_resp.status_code == 200:
                    teams = lookup_resp.json().get('data', [])
                    if teams:
                        ctfd_id = teams[0]['id']
                        self.ctfd_team_id = ctfd_id
                        self.save(update_fields=['ctfd_team_id'])
                        logger.info(f"âœ… {self.team_name} FOUND: CTFd ID {ctfd_id}")
                        return ctfd_id
                
                logger.warning(f"Lookup {attempt+1} empty response")
                time.sleep(2 ** attempt)  # 1s, 2s, 4s
                
            except Exception as e:
                logger.error(f"âŒ Lookup {attempt+1} failed: {e}")
        
        logger.error(f"âŒ COMPLETE FAILURE: {self.team_name} not synced")
        return None
    
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/serializers.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 30 | Size: 4.0K

from rest_framework import serializers
from .models import Team
from django.contrib.auth import authenticate

class TeamSerializer(serializers.ModelSerializer):
    team_name = serializers.CharField()
    password = serializers.CharField(write_only=True)

    class Meta:  # âœ… Add this
        model = Team
        fields = ['team_name', 'password']

    def validate(self,data):
        team_name = data.get('team_name')
        password = data.get('password')

        if team_name and password:
            try:
                team = Team.objects.get(team_name=team_name)
            except Team.DoesNotExist:
                raise serializers.ValidationError('Invalid team name or password')
            
            if not team.check_password(password):
                raise serializers.ValidationError('Invalid team name or password')
            if not team.is_active:
                raise serializers.ValidationError('Team account is disabled')
            
            data['user'] = team
        else:
            raise serializers.ValidationError('Must include team name and password')
        return data
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/tasks.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 46 | Size: 4.0K

from celery import shared_task
from .models import Team
import csv
import os
from django.conf import settings
from datetime import datetime

@shared_task(bind=True)
def sync_team_to_ctfd_task(self, team_id, plaintext_password):
    """Background CTFd sync with CSV update"""
    try:
        team = Team.objects.get(id=team_id)
        ctfd_id = team.sync_to_ctfd(plaintext_password)
        
        if ctfd_id:
            # Update CSV with successful sync
            _update_csv_status(team.team_name, ctfd_id)
        
        return f"Team {team.team_name}: CTFd ID {ctfd_id}"
    except Team.DoesNotExist:
        return "Team not found"

def _update_csv_status(team_name, ctfd_id):
    """Update CSV file with CTFd ID for previously failed syncs"""
    csv_dir = getattr(settings, 'TEAM_PASSWORDS_DIR', os.path.join(settings.BASE_DIR, 'secure_data'))
    csv_file = os.path.join(csv_dir, 'team_passwords.csv')
    
    if not os.path.exists(csv_file):
        return
    
    # Read all rows
    rows = []
    with open(csv_file, 'r', newline='', encoding='utf-8') as f:
        reader = csv.reader(f)
        header = next(reader)
        rows.append(header)
        
        for row in reader:
            if row[0] == team_name and row[3] == 'PENDING':
                row[3] = str(ctfd_id)
                row[5] = 'Synced'
            rows.append(row)
    
    # Write back
    with open(csv_file, 'w', newline='', encoding='utf-8') as f:
        writer = csv.writer(f)
        writer.writerows(rows)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/tests.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 3 | Size: 0

from django.test import TestCase

# Create your tests here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/urls.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 8 | Size: 0

from django.urls import path
from rest_framework_simplejwt.views import TokenRefreshView
from .views import TeamLoginView, TeamLogoutView, TeamProfileView
urlpatterns = [
        path('login/', TeamLoginView.as_view(), name='team_login'),
        path('token/refresh/', TokenRefreshView.as_view(), name='token-refresh'),
        path('profile/', TeamProfileView.as_view(), name='team_profile'),
        path('logout/', TeamLogoutView.as_view(), name='team_logout'),
]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: teams/views.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 99 | Size: 4.0K

from django.shortcuts import render
from .models import Team
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from rest_framework.permissions import AllowAny , IsAuthenticated
from django.contrib.auth.hashers import check_password
from rest_framework_simplejwt.tokens import RefreshToken
from django.contrib.auth import authenticate
from .serializers import TeamSerializer
from ctfd.service import CTFdService
from hackathon.models import Project
from django.db.models import Sum
from django_ratelimit.decorators import ratelimit
from django.utils.decorators import method_decorator

@method_decorator(ratelimit(key='ip', rate='5/m'), name='dispatch')
class TeamLoginView(APIView):
    permission_classes = [AllowAny]
    def post(self, request):
        serializer = TeamSerializer(data=request.data)
        
        # 1. Validate input (checks team existence & password)
        if serializer.is_valid():
            team = serializer.validated_data['user']
            
            # 2. Generate JWT tokens manually
            refresh = RefreshToken.for_user(team)
            
            # 3. Add custom claims if needed (optional)
            refresh['team_name'] = team.team_name

            return Response({
                "success": True,
                "message": "Login successful",
                "data": {
                    "team_name": team.team_name,
                    "ctfd_team_id": team.ctfd_team_id,
                    "access": str(refresh.access_token),   # should be stored in the frontend for authenticated requests
                    "refresh": str(refresh)                # stored in the front end can be used to get new access tokens when the old one expires
                }
            }, status=status.HTTP_200_OK)
            
        return Response({
            "success": False,
            "errors": serializer.errors
        }, status=status.HTTP_400_BAD_REQUEST)

class TeamProfileView(APIView):

    permission_classes = [IsAuthenticated]

    def get(self, request):
        team = request.user
        team__ctfd_score = CTFdService.get_team_score(team.ctfd_team_id)
        
        try :
            project = Project.objects.get(team=team)
            team__project_score = project.total_score
        except Project.DoesNotExist:
            team__project_score = 0

        team__token_score = team.token_submissions.aggregate(total=Sum('token__base_points'))['total'] or 0

        team__total_score = team__ctfd_score + team__project_score + team__token_score

        return Response({
            "success": True,
            "data":{
                "team_name": team.team_name,
                "ctfd_team_id": team.ctfd_team_id,
                "email": team.email,
                "created_at": team.created_at,
                "ctfd_score": team__ctfd_score,
                "project_score": team__project_score,
                "token_score": team__token_score,
                "total_score": team__total_score
            }
        }, status=status.HTTP_200_OK)
    
class TeamLogoutView(APIView):
    permission_classes = [IsAuthenticated]

    def post(self, request):
        try:
            # Blacklist the refresh token
            refresh_token = request.data.get("refresh")
            token = RefreshToken(refresh_token)
            token.blacklist()

            return Response({
                "success": True,
                "message": "Logout successful"
                  }, status=status.HTTP_200_OK)
        except Exception as e:
            return Response({
                "success": False, 
                "message": str(e)}
                , status=status.HTTP_400_BAD_REQUEST)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - tokens/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/admin.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 39 | Size: 4.0K

# tokens/admin.py

from django.contrib import admin
from .models import Token, TokenSubmission
import secrets
import string
import hashlib

@admin.register(Token)
class TokenAdmin(admin.ModelAdmin):
    list_display = ('base_points', 'created_at', 'submission_count')
    list_filter = ('base_points', 'created_at')
    ordering = ('-created_at',)
    readonly_fields = ('token_hash', 'created_at')
    
    def submission_count(self, obj):
        return obj.submissions.count()
    submission_count.short_description = 'Submissions'
    
    fieldsets = (
        ('Token Info', {
            'fields': ('base_points', 'token_hash', 'created_at')
        }),
    )


@admin.register(TokenSubmission)
class TokenSubmissionAdmin(admin.ModelAdmin):
    list_display = ('team', 'token_points', 'submitted_at')
    list_filter = ('submitted_at', 'token__base_points')
    search_fields = ('team__team_name',)
    readonly_fields = ('team', 'token', 'submitted_at')
    ordering = ('-submitted_at',)
    
    def token_points(self, obj):
        return f"{obj.token.base_points} pts"
    token_points.short_description = 'Points'
    
    def has_add_permission(self, request):
        return False  # Tokens can only be submitted via API
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/apps.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 5 | Size: 4.0K

from django.apps import AppConfig


class TokensConfig(AppConfig):
    name = 'tokens'

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/migrations/0001_initial.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 42 | Size: 4.0K

# Generated by Django 6.0.1 on 2026-02-09 18:19

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Token',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('token_hash', models.CharField(max_length=128)),
                ('base_points', models.IntegerField(choices=[(5, '5 points'), (10, '10 points'), (15, '15 points'), (20, '20 points'), (30, '30 points'), (50, '50 points')])),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'ordering': ['base_points'],
            },
        ),
        migrations.CreateModel(
            name='TokenSubmission',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('submitted_at', models.DateTimeField(auto_now_add=True)),
                ('team', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='token_submissions', to=settings.AUTH_USER_MODEL)),
                ('token', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='submissions', to='tokens.token')),
            ],
            options={
                'ordering': ['-submitted_at'],
                'unique_together': {('team', 'token')},
            },
        ),
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/migrations/0002_alter_token_base_points.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 18 | Size: 1.0K

# Generated by Django 6.0.1 on 2026-02-10 10:06

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('tokens', '0001_initial'),
    ]

    operations = [
        migrations.AlterField(
            model_name='token',
            name='base_points',
            field=models.IntegerField(choices=[(5, '5 points'), (10, '10 points'), (15, '15 points'), (20, '20 points'), (30, '30 points'), (40, '40 points'), (50, '50 points'), (60, '60 points')]),
        ),
    ]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/migrations/__init__.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 0 | Size: 0

[BINARY/NON-TEXT FILE - tokens/migrations/__init__.py: empty]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/models.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 52 | Size: 4.0K

# tokens/models.py (or flags/models.py)

from django.db import models
from django.contrib.auth.hashers import make_password, check_password

class Token(models.Model):
    token_hash = models.CharField(max_length=128)
    base_points = models.IntegerField(
        choices=[
            (5, '5 points'),
            (10, '10 points'),
            (15, '15 points'),
            (20, '20 points'),
            (30, '30 points'),
            (40, '40 points'),
            (50, '50 points'),
            (60, '60 points'),
        ]
    )
    created_at = models.DateTimeField(auto_now_add=True)

    class Meta:
        ordering = ['base_points']

    def __str__(self):
        return f"{self.base_points} pts"

    def set_hash(self, raw_token):
        self.token_hash = make_password(raw_token)

    def check_token(self, raw_token):
        return check_password(raw_token, self.token_hash)


class TokenSubmission(models.Model):
    team = models.ForeignKey(
        'teams.Team',
        on_delete=models.CASCADE,
        related_name='token_submissions'
    )
    token = models.ForeignKey(  
        Token,
        on_delete=models.CASCADE,
        related_name='submissions'
    )
    submitted_at = models.DateTimeField(auto_now_add=True)

    class Meta:
        unique_together = ('team', 'token') 
        ordering = ['-submitted_at']
    
    def __str__(self):
        return f"{self.team.team_name} - {self.token.base_points} pts"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/serializers.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 50 | Size: 4.0K

# flags/serializers.py

from rest_framework import serializers
from .models import Token, TokenSubmission
import re

class TokenSubmitSerializer(serializers.Serializer):
    token = serializers.CharField(max_length=200)
    
    def validate_token(self, value):  
        
        if not re.match(r'^CIC\{.+\}$', value):
            raise serializers.ValidationError(
                "Invalid token format. Must start with CIC{ and end with }"
            )
        
        if len(value) < 32:
            raise serializers.ValidationError(
                "Token is too short"
            )
        
        return value


class TokenSubmissionSerializer(serializers.ModelSerializer):
    team_name = serializers.CharField(source='team.team_name', read_only=True)
    points = serializers.IntegerField(source='token.base_points', read_only=True)
    submitted_at = serializers.DateTimeField(read_only=True)
    
    class Meta:
        model = TokenSubmission
        fields = ['id', 'team_name', 'points', 'submitted_at']
        read_only_fields = ['id', 'team_name', 'points', 'submitted_at']


class TeamTokenHistorySerializer(serializers.ModelSerializer):
    """For showing a team's token submission history"""
    points = serializers.IntegerField(source='token.base_points', read_only=True)
    submitted_at = serializers.DateTimeField(read_only=True)
    
    class Meta:
        model = TokenSubmission
        fields = ['id', 'points', 'submitted_at']
        read_only_fields = fields


class TeamTokenStatsSerializer(serializers.Serializer):
    """For showing team's total points from tokens"""
    total_tokens = serializers.IntegerField()
    total_points = serializers.IntegerField()
    submissions = TeamTokenHistorySerializer(many=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/services.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 48 | Size: 4.0K

import hashlib
import secrets
import csv
from io import StringIO
from django.conf import settings
from django.http import HttpResponse
from .models import Token

class TokenGenerator:
    @staticmethod
    def generate_md5_token():
        random_bytes = secrets.token_bytes(8)  # 64 bits randomness
        md5_hash = hashlib.md5(random_bytes).hexdigest()[:32]  
        return md5_hash
    
    @staticmethod
    def generate_and_store_token(num_5pts,num_10pts,num_15pts,num_20pts,num_30pts,num_50pts):

        token_group = {
            5:num_5pts,
            10:num_10pts,
            15:num_15pts,
            20:num_20pts,
            30:num_30pts,
            50:num_50pts,
        }
        output = StringIO()
        writer = csv.writer(output)
        writer.writerow(['Token', 'Base Points'])
        created_count = 0
        for points, count in token_group.items():
            if count > 0:
                tokens = []
                for _ in range(count):
                    raw_token = TokenGenerator.generate_md5_token()
                    token = Token(base_points=points)
                    token.set_hash(raw_token)
                    token.save()
                    tokens.append(raw_token)
                    created_count += 1
                    writer.writerow([points,raw_token])


        response = HttpResponse(output.getvalue(), content_type='text/csv')
        response['Content-Disposition'] = f'attachment; filename="ciconix_tokens_{created_count}_tokens.csv"'
        
        return response
    

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/tests.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 3 | Size: 0

from django.test import TestCase

# Create your tests here.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/urls.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 6 | Size: 0

from django.urls import path
from .views import TokenSubmitView, TeamTokenHistoryView

urlpatterns = [
    path('submit/', TokenSubmitView.as_view(), name='token_submit'),
    path('history/', TeamTokenHistoryView.as_view(), name='team_token_history'),
]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/utils.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 63 | Size: 4.0K

# flags/utils.py

import hashlib
import secrets
import csv
import os
from django.conf import settings
from .models import Token
from datetime import datetime


def generate_tokens(num_5=0, num_10=0, num_15=0, num_20=0, num_30=0,num_40=0, num_50=0,num_60=0):
    """
    Simple function to generate tokens and save to CSV.
    
    Usage in Django shell:
        python manage.py shell
        >>> from flags.utils import generate_tokens
        >>> generate_tokens(num_5=5, num_10=3, num_20=2)
    """
    
    token_groups = {
        5: num_5,
        10: num_10,
        15: num_15,
        20: num_20,
        30: num_30,
        40: num_40,
        50: num_50,
        60: num_60,
    }
    
    # Create secure_data directory
    csv_dir = os.path.join(settings.BASE_DIR, 'secure_data')
    os.makedirs(csv_dir, exist_ok=True)
    
    # Prepare CSV file
    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
    csv_file = os.path.join(csv_dir, f'tokens_{timestamp}.csv')
    
    created_count = 0
    
    with open(csv_file, 'w', newline='', encoding='utf-8') as f:
        writer = csv.writer(f)
        writer.writerow(['Token', 'Points'])
        
        for points, count in token_groups.items():
            for _ in range(count):
                # Generate MD5 hash
                random_bytes = secrets.token_bytes(16)
                md5_hash = hashlib.md5(random_bytes).hexdigest()
                raw_token = f"CIC{{{md5_hash}}}"
                
                # Save to database
                token = Token(base_points=points)
                token.set_hash(raw_token)
                token.save()
                
                writer.writerow([raw_token, points])
                created_count += 1
    
    print(f"âœ… Generated {created_count} tokens")
    print(f"ðŸ“ Saved to: {csv_file}")
    return csv_file
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: tokens/views.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 68 | Size: 4.0K

from django.shortcuts import render
from teams.models import Team
from .models import Token , TokenSubmission
from .serializers import TokenSubmitSerializer, TokenSubmissionSerializer, TeamTokenHistorySerializer, TeamTokenStatsSerializer
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from rest_framework.permissions import AllowAny , IsAuthenticated
from django.contrib.auth.hashers import check_password ,make_password
from rest_framework_simplejwt.tokens import RefreshToken
from django.contrib.auth import authenticate
from django.db.models import Sum


class TokenSubmitView(APIView):
    permission_classes = [IsAuthenticated]

    def post(self, request):
        serializer = TokenSubmitSerializer(data=request.data)
        if serializer.is_valid():
            raw_token = serializer.validated_data['token']
            token = None

            for t in Token.objects.all():
                if t.check_token(raw_token):
                    token = t
                    break
            
            if token is None:
                return Response({
                    "success": False,
                    "message": "Invalid token"
                }, status=status.HTTP_400_BAD_REQUEST)
            

            team = request.user
            if TokenSubmission.objects.filter(team=team, token=token).exists():
                return Response({
                    "success": False,
                    "message": "Token already submitted by this team"
                }, status=status.HTTP_400_BAD_REQUEST)
            
            submission = TokenSubmission.objects.create(team=team, token=token)

            return Response({
                "success": True,
                "message": "Token submitted successfully",
                "data": TokenSubmissionSerializer(submission).data
            }, status=status.HTTP_201_CREATED)
        
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
    
class TeamTokenHistoryView(APIView):
    permission_classes = [IsAuthenticated]

    def get(self, request):
        team = request.user
        submission = TokenSubmission.objects.filter(team=team)

        stats = {
            "total_tokens": submission.count(),
            "total_points": submission.aggregate(total=Sum('token__base_points')).get('total') or 0
        }
        serializer = TeamTokenHistorySerializer(submission, many=True)
        return Response({
            "success": True,
            "data": serializer.data,
            "stats": stats
        },status=status.HTTP_200_OK)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“„ FILE: utils.py
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Lines: 5 | Size: 0


def get_team_identifier(group, request):
    """Rate limit by team ID instead of IP"""
    if request.user.is_authenticated:
        return f"team_{request.user.id}"
    return request.META.get('REMOTE_ADDR')
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… Dump completed!
ðŸ“Š Total files: 79
ðŸ’¾ Output file: project_files_dump.txt (140K)
